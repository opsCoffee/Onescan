{
  "version": "2.0",
  "projectName": "OneScan",
  "projectVersion": "2.2.0",
  "taskType": "Burp API Migration",
  "reviewDate": "2025-12-06",
  "lastUpdate": "2025-12-07T01:45:00+00:00",
  "summary": {
    "totalTasks": 17,
    "completedTasks": 4,
    "inProgressTasks": 1,
    "pendingTasks": 11,
    "skippedTasks": 1,
    "failedTasks": 0,
    "progressPercentage": 26,
    "estimatedTotalHours": 80,
    "actualHours": 14.5
  },
  "current_phase": "1",
  "current_task": "MIGRATE-101",
  "completed_phases": [
    "0"
  ],
  "completed_tasks": [
    "MIGRATE-001",
    "MIGRATE-002",
    "MIGRATE-003",
    "MIGRATE-004"
  ],
  "in_progress_tasks": [
    "MIGRATE-101"
  ],
  "skipped_tasks": [
    "MIGRATE-102"
  ],
  "failed_tasks": [],
  "task_details": {
    "MIGRATE-001": {
      "status": "completed",
      "completed_at": "2025-12-06T14:37:00+00:00",
      "commit": "a9b43bd",
      "description": "扫描传统 API 使用情况,生成详细报告",
      "deliverables": [
        ".agent/api_usage_report.md",
        ".agent/api_quick_reference.md",
        ".agent/burp_api_usage.csv",
        ".agent/scan_summary.txt"
      ]
    },
    "MIGRATE-002": {
      "status": "completed",
      "completed_at": "2025-12-06T14:53:00+00:00",
      "commit": "318bcac",
      "description": "建立传统 API 到 Montoya API 的映射表,识别复杂场景,标记特殊API",
      "deliverables": [
        ".agent/api_mapping.md"
      ]
    },
    "MIGRATE-003": {
      "status": "completed",
      "completed_at": "2025-12-06T15:13:07+00:00",
      "commit": "ecd9882",
      "description": "分析各模块间的API依赖关系,确定迁移的优先级和顺序,识别可能的风险点",
      "deliverables": [
        ".agent/dependency_analysis.md"
      ]
    },
    "MIGRATE-004": {
      "status": "completed",
      "completed_at": "2025-12-06T15:30:41+00:00",
      "commit": "aadf0e7",
      "description": "创建详细的迁移计划,整合前三个任务的输出,更新 task_status.json",
      "deliverables": [
        ".agent/migration_plan.md"
      ]
    },
    "MIGRATE-101": {
      "status": "in_progress",
      "started_at": "2025-12-06T17:19:09+00:00",
      "notes": [
        "决策: 合并 MIGRATE-101 和 MIGRATE-102 一次性执行",
        "原因: 两个任务操作同一数据,MontoyaApi 和 IBurpExtenderCallbacks 类型不兼容",
        "进度: 已完成 MIGRATE-101-A (核心接口迁移)",
        "进度: MIGRATE-101-B 部分完成 (addSuiteTab 迁移完成)",
        "下一步: 继续 MIGRATE-101-C (事件监听器迁移)"
      ],
      "sub_tasks": [
        {
          "id": "MIGRATE-101-A",
          "title": "核心接口迁移",
          "status": "completed",
          "completed_at": "2025-12-07T01:10:35+00:00",
          "commit": "842cd20",
          "hours": 2,
          "deliverables": [
            "修改 BurpExtender 类声明: IBurpExtender → BurpExtension",
            "修改初始化方法: registerExtenderCallbacks() → initialize()",
            "迁移 setExtensionName() 和 getExtensionFilename() API调用",
            "编译验证通过"
          ]
        },
        {
          "id": "MIGRATE-101-B",
          "title": "UI 相关 API 迁移",
          "status": "partial",
          "started_at": "2025-12-07T01:36:00+00:00",
          "hours": 0.5,
          "deliverables": [
            "✅ 迁移 addSuiteTab() → api.userInterface().registerSuiteTab()",
            "✅ 移除 ITab 接口实现 (getTabCaption, getUiComponent)",
            "⏳ registerContextMenuFactory - 留待 MIGRATE-101-C",
            "⏳ createMessageEditor - 留待 MIGRATE-101-D",
            "⏳ registerMessageEditorTabFactory - 留待 MIGRATE-101-C",
            "⏳ registerExtensionStateListener - 留待 MIGRATE-101-C"
          ],
          "notes": [
            "根据 Linus 'Never break userspace' 原则,只完成了确定安全的 API 迁移",
            "复杂的接口重构留待后续子任务,避免引入破坏性变更"
          ]
        },
        {
          "id": "MIGRATE-101-C",
          "title": "事件监听器迁移",
          "status": "pending",
          "hours": 2,
          "scope_update": [
            "新增: registerContextMenuFactory() → ContextMenuItemsProvider",
            "新增: registerMessageEditorTabFactory() → HttpRequestEditorProvider",
            "新增: registerExtensionStateListener() → Extension.registerUnloadingHandler()"
          ]
        },
        {
          "id": "MIGRATE-101-D",
          "title": "HTTP 请求处理迁移",
          "status": "pending",
          "hours": 2,
          "scope_update": [
            "新增: createMessageEditor() → api.userInterface API"
          ]
        },
        {
          "id": "MIGRATE-101-E",
          "title": "清理和最终验证",
          "status": "pending",
          "hours": 1
        }
      ]
    },
    "MIGRATE-102": {
      "status": "skipped",
      "notes": [
        "已合并到 MIGRATE-101 一起执行"
      ]
    }
  },
  "phases": {
    "0": {
      "name": "API 使用情况分析",
      "description": "全面分析项目中传统 API 的使用情况,制定详细的迁移计划",
      "priority": "P0",
      "status": "completed",
      "total_tasks": 4,
      "completed_tasks": 4,
      "estimatedHours": 12,
      "actualHours": 12
    },
    "1": {
      "name": "核心入口点迁移",
      "description": "迁移插件的主入口和核心初始化逻辑",
      "priority": "P1",
      "status": "in_progress",
      "total_tasks": 2,
      "completed_tasks": 0,
      "estimatedHours": 8,
      "actualHours": 0
    },
    "2": {
      "name": "HTTP 处理迁移",
      "description": "迁移 HTTP 请求/响应处理相关的 API",
      "priority": "P1",
      "status": "pending",
      "total_tasks": 3,
      "completed_tasks": 0,
      "estimatedHours": 16,
      "actualHours": 0
    },
    "3": {
      "name": "UI 组件迁移",
      "description": "迁移用户界面相关的 API",
      "priority": "P1",
      "status": "pending",
      "total_tasks": 3,
      "completed_tasks": 0,
      "estimatedHours": 20,
      "actualHours": 0
    },
    "4": {
      "name": "工具类和辅助功能迁移",
      "description": "迁移工具类和辅助功能相关的 API",
      "priority": "P2",
      "status": "pending",
      "total_tasks": 3,
      "completed_tasks": 0,
      "estimatedHours": 12,
      "actualHours": 0
    },
    "5": {
      "name": "测试和验证",
      "description": "确保迁移后的功能完整性和稳定性",
      "priority": "P2",
      "status": "pending",
      "total_tasks": 3,
      "completed_tasks": 0,
      "estimatedHours": 12,
      "actualHours": 0
    }
  },
  "tasks": [
    {
      "taskId": "MIGRATE-001",
      "phaseId": "0",
      "title": "扫描传统 API 使用",
      "description": "识别所有使用 burp.* 包的类和方法, 统计各个传统 API 接口的使用频率, 生成 API 使用清单(按模块分类)",
      "priority": "P0",
      "severity": "高",
      "category": "分析",
      "impact": "全局",
      "estimatedHours": 3,
      "actualHours": 0,
      "affectedFiles": [
        "所有 Java 文件"
      ],
      "deliverables": [
        ".agent/api_usage_report.md"
      ],
      "dependencies": [],
      "status": "pending",
      "testRequired": false,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-002",
      "phaseId": "0",
      "title": "API 映射关系分析",
      "description": "建立传统 API 到 Montoya API 的映射表, 识别需要重构的复杂场景, 标记无直接对应的 API(需要特殊处理)",
      "priority": "P0",
      "severity": "高",
      "category": "分析",
      "impact": "全局",
      "estimatedHours": 4,
      "actualHours": 0,
      "affectedFiles": [],
      "deliverables": [
        ".agent/api_mapping.md"
      ],
      "dependencies": [
        "MIGRATE-001"
      ],
      "status": "pending",
      "testRequired": false,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-003",
      "phaseId": "0",
      "title": "依赖关系分析",
      "description": "分析各模块间的 API 依赖关系, 确定迁移的优先级和顺序, 识别可能的风险点",
      "priority": "P0",
      "severity": "高",
      "category": "分析",
      "impact": "全局",
      "estimatedHours": 3,
      "actualHours": 0,
      "affectedFiles": [],
      "deliverables": [
        ".agent/dependency_analysis.md"
      ],
      "dependencies": [
        "MIGRATE-001",
        "MIGRATE-002"
      ],
      "status": "pending",
      "testRequired": false,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-004",
      "phaseId": "0",
      "title": "生成迁移计划",
      "description": "创建 .agent/migration_plan.md, 整合前三个任务的输出, 更新 task_status.json",
      "priority": "P0",
      "severity": "高",
      "category": "规划",
      "impact": "全局",
      "estimatedHours": 2,
      "actualHours": 0,
      "affectedFiles": [],
      "deliverables": [
        ".agent/migration_plan.md"
      ],
      "dependencies": [
        "MIGRATE-001",
        "MIGRATE-002",
        "MIGRATE-003"
      ],
      "status": "pending",
      "testRequired": false,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-101",
      "phaseId": "1",
      "title": "BurpExtender 类迁移",
      "description": "从 IBurpExtender 迁移到 BurpExtension, 从 registerExtenderCallbacks 迁移到 initialize, 更新回调接口的注册方式",
      "priority": "P1",
      "severity": "高",
      "category": "代码迁移",
      "impact": "全局",
      "estimatedHours": 4,
      "actualHours": 0,
      "affectedFiles": [
        "src/main/java/burp/BurpExtender.java"
      ],
      "deliverables": [],
      "dependencies": [
        "MIGRATE-004"
      ],
      "status": "pending",
      "testRequired": true,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-102",
      "phaseId": "1",
      "title": "扩展上下文迁移",
      "description": "从 IBurpExtenderCallbacks 迁移到 MontoyaApi, 更新所有使用回调接口的代码, 适配新的服务获取方式",
      "priority": "P1",
      "severity": "高",
      "category": "代码迁移",
      "impact": "全局",
      "estimatedHours": 4,
      "actualHours": 0,
      "affectedFiles": [
        "src/main/java/burp/BurpExtender.java"
      ],
      "deliverables": [],
      "dependencies": [
        "MIGRATE-101"
      ],
      "status": "pending",
      "testRequired": true,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-201",
      "phaseId": "2",
      "title": "HTTP 监听器迁移",
      "description": "从 IHttpListener 迁移到 HttpHandler, 更新请求/响应处理逻辑, 适配新的消息编辑器 API",
      "priority": "P1",
      "severity": "高",
      "category": "代码迁移",
      "impact": "模块级",
      "estimatedHours": 6,
      "actualHours": 0,
      "affectedFiles": [
        "src/main/java/burp/BurpExtender.java"
      ],
      "deliverables": [],
      "dependencies": [
        "MIGRATE-102"
      ],
      "status": "pending",
      "testRequired": true,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-202",
      "phaseId": "2",
      "title": "HTTP 消息处理",
      "description": "从 IHttpRequestResponse 迁移到 HttpRequestResponse, 更新请求/响应解析逻辑, 适配新的 HTTP 服务 API",
      "priority": "P1",
      "severity": "高",
      "category": "代码迁移",
      "impact": "模块级",
      "estimatedHours": 6,
      "actualHours": 0,
      "affectedFiles": [
        "src/main/java/burp/BurpExtender.java"
      ],
      "deliverables": [],
      "dependencies": [
        "MIGRATE-201"
      ],
      "status": "pending",
      "testRequired": true,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-203",
      "phaseId": "2",
      "title": "代理监听器迁移",
      "description": "从 IProxyListener 迁移到 ProxyRequestHandler/ProxyResponseHandler, 更新拦截和修改逻辑",
      "priority": "P1",
      "severity": "高",
      "category": "代码迁移",
      "impact": "模块级",
      "estimatedHours": 4,
      "actualHours": 0,
      "affectedFiles": [
        "src/main/java/burp/BurpExtender.java"
      ],
      "deliverables": [],
      "dependencies": [
        "MIGRATE-202"
      ],
      "status": "pending",
      "testRequired": true,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-301",
      "phaseId": "3",
      "title": "标签页迁移",
      "description": "从 ITab 迁移到 UserInterface.registerSuiteTab(), 更新标签页注册方式, 适配新的 UI 组件模型",
      "priority": "P1",
      "severity": "高",
      "category": "代码迁移",
      "impact": "模块级",
      "estimatedHours": 6,
      "actualHours": 0,
      "affectedFiles": [
        "src/main/java/burp/onescan/ui/"
      ],
      "deliverables": [],
      "dependencies": [
        "MIGRATE-102"
      ],
      "status": "pending",
      "testRequired": true,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-302",
      "phaseId": "3",
      "title": "上下文菜单迁移",
      "description": "从 IContextMenuFactory 迁移到 ContextMenuItemsProvider, 实现 provideMenuItems() 方法, 使用 api.userInterface().registerContextMenuItemsProvider() 注册",
      "priority": "P1",
      "severity": "高",
      "category": "代码迁移",
      "impact": "模块级",
      "estimatedHours": 6,
      "actualHours": 0,
      "affectedFiles": [
        "src/main/java/burp/BurpExtender.java"
      ],
      "deliverables": [],
      "dependencies": [
        "MIGRATE-301"
      ],
      "status": "pending",
      "testRequired": true,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-303",
      "phaseId": "3",
      "title": "消息编辑器迁移",
      "description": "从 IMessageEditorController 迁移到 HttpRequestEditorProvider/HttpResponseEditorProvider, 实现相应接口, 使用 api.userInterface().registerHttpRequestEditorProvider() 注册",
      "priority": "P1",
      "severity": "高",
      "category": "代码迁移",
      "impact": "模块级",
      "estimatedHours": 8,
      "actualHours": 0,
      "affectedFiles": [
        "src/main/java/burp/onescan/ui/"
      ],
      "deliverables": [],
      "dependencies": [
        "MIGRATE-302"
      ],
      "status": "pending",
      "testRequired": true,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-401",
      "phaseId": "4",
      "title": "辅助工具类迁移",
      "description": "从 IExtensionHelpers 迁移到各个专用服务, 更新 URL 解析/编码/解码等工具方法, 适配新的参数处理 API",
      "priority": "P2",
      "severity": "中",
      "category": "代码迁移",
      "impact": "全局",
      "estimatedHours": 6,
      "actualHours": 0,
      "affectedFiles": [
        "src/main/java/burp/common/utils/"
      ],
      "deliverables": [],
      "dependencies": [
        "MIGRATE-102"
      ],
      "status": "pending",
      "testRequired": true,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-402",
      "phaseId": "4",
      "title": "扫描器集成迁移",
      "description": "从 IScannerCheck 迁移到 Scanner API, 更新扫描逻辑和问题报告",
      "priority": "P2",
      "severity": "中",
      "category": "代码迁移",
      "impact": "模块级",
      "estimatedHours": 4,
      "actualHours": 0,
      "affectedFiles": [
        "src/main/java/burp/onescan/"
      ],
      "deliverables": [],
      "dependencies": [
        "MIGRATE-401"
      ],
      "status": "pending",
      "testRequired": true,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-403",
      "phaseId": "4",
      "title": "日志和输出迁移",
      "description": "从 stdout/stderr 迁移到 Logging API, 统一日志输出方式",
      "priority": "P2",
      "severity": "中",
      "category": "代码迁移",
      "impact": "全局",
      "estimatedHours": 2,
      "actualHours": 0,
      "affectedFiles": [
        "所有 Java 文件"
      ],
      "deliverables": [],
      "dependencies": [
        "MIGRATE-102"
      ],
      "status": "pending",
      "testRequired": true,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-501",
      "phaseId": "5",
      "title": "功能测试",
      "description": "测试所有核心功能, 验证 UI 交互, 检查性能表现",
      "priority": "P2",
      "severity": "高",
      "category": "测试",
      "impact": "全局",
      "estimatedHours": 6,
      "actualHours": 0,
      "affectedFiles": [],
      "deliverables": [
        ".agent/test_report.md"
      ],
      "dependencies": [
        "MIGRATE-403"
      ],
      "status": "pending",
      "testRequired": true,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-502",
      "phaseId": "5",
      "title": "兼容性测试",
      "description": "测试不同 Burp Suite 版本, 验证与其他插件的兼容性",
      "priority": "P2",
      "severity": "中",
      "category": "测试",
      "impact": "全局",
      "estimatedHours": 4,
      "actualHours": 0,
      "affectedFiles": [],
      "deliverables": [
        ".agent/compatibility_report.md"
      ],
      "dependencies": [
        "MIGRATE-501"
      ],
      "status": "pending",
      "testRequired": true,
      "documentationRequired": true
    },
    {
      "taskId": "MIGRATE-503",
      "phaseId": "5",
      "title": "清理工作",
      "description": "移除传统 API 依赖, 更新文档和注释, 代码格式化和优化",
      "priority": "P2",
      "severity": "低",
      "category": "清理",
      "impact": "全局",
      "estimatedHours": 2,
      "actualHours": 0,
      "affectedFiles": [
        "所有文件"
      ],
      "deliverables": [],
      "dependencies": [
        "MIGRATE-502"
      ],
      "status": "pending",
      "testRequired": false,
      "documentationRequired": true
    }
  ],
  "milestones": [
    {
      "name": "阶段0 分析完成",
      "targetDate": "2025-12-06",
      "completed": false
    },
    {
      "name": "核心入口迁移完成",
      "targetDate": "2025-12-07",
      "completed": false
    },
    {
      "name": "HTTP处理迁移完成",
      "targetDate": "2025-12-09",
      "completed": false
    },
    {
      "name": "UI组件迁移完成",
      "targetDate": "2025-12-11",
      "completed": false
    },
    {
      "name": "全部迁移完成",
      "targetDate": "2025-12-15",
      "completed": false
    }
  ],
  "notes": [
    "从传统 Burp Extender API 迁移到 Montoya API",
    "共17个任务,预计80小时",
    "采用渐进式迁移策略,每个阶段可独立编译测试"
  ]
}