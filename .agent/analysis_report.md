# OneScan é¡¹ç›®ä»£ç è¯„å®¡æŠ¥å‘Š

**è¯„å®¡æ—¥æœŸ**: 2025-12-05
**é¡¹ç›®ç‰ˆæœ¬**: 2.2.0
**è¯„å®¡äºº**: Claude (Linus Mode)
**è¯„å®¡èŒƒå›´**: å…¨é¡¹ç›®ä»£ç è´¨é‡è¯„å®¡

---

## æ‰§è¡Œæ‘˜è¦

### é¡¹ç›®å¥åº·åº¦è¯„åˆ†

**æ€»åˆ†**: 72/100

- å®‰å…¨æ€§: 65/100  âš ï¸ éœ€è¦æ”¹è¿›
- å¹¶å‘æ€§: 75/100
- æ€§èƒ½: 70/100
- å¯é æ€§: 68/100  âš ï¸ éœ€è¦æ”¹è¿›
- å¯ç»´æŠ¤æ€§: 70/100
- ä»£ç è§„èŒƒ: 85/100  âœ… è‰¯å¥½

### å…³é”®å‘ç°ï¼ˆTop 5ï¼‰

1. **[P0-ä¸¥é‡]** YAML ååºåˆ—åŒ– DoS æ¼æ´ - CodePointLimit è¿‡é«˜
2. **[P0-ä¸¥é‡]** å­—ç¬¦ç¼–ç é£é™©å¯¼è‡´é…ç½®æ–‡ä»¶ä¹±ç å’Œæ•°æ®ä¸¢å¤±
3. **[P0-ä¸¥é‡]** å¼‚å¸¸ä¿¡æ¯æ³„éœ² - 14 å¤„ printStackTrace() æš´éœ²å†…éƒ¨è·¯å¾„
4. **[P1-é«˜]** èµ„æºæ³„æ¼é£é™© - æ–‡ä»¶å¥æŸ„æœªæ­£ç¡®å…³é—­
5. **[P1-é«˜]** çº¿ç¨‹å®‰å…¨é—®é¢˜ - ç«æ€æ¡ä»¶å’Œæ•°ç»„è¶Šç•Œé£é™©

### Linus å¼è¯„ä»·

> "æœ€æ ¸å¿ƒçš„é—®é¢˜æœ‰ä¸‰ä¸ªï¼šç¬¬ä¸€ï¼ŒBurpExtender æ˜¯ä¸ª 1889 è¡Œçš„æ€ªç‰©ï¼ŒæŠŠæ‰€æœ‰ä¸œè¥¿å¡è¿›å»äº†ã€‚ç¬¬äºŒï¼Œå­—ç¬¦ç¼–ç é—®é¢˜ä¼šåœ¨ä¸­æ–‡ç¯å¢ƒä¸‹ç›´æ¥ç‚¸æ‰ä½ çš„é…ç½®æ–‡ä»¶ã€‚ç¬¬ä¸‰ï¼Œå¼‚å¸¸å¤„ç†æ˜¯åƒåœ¾ - printStackTrace() åˆ°å¤„éƒ½æ˜¯ï¼Œç”Ÿäº§ç¯å¢ƒæš´éœ²è·¯å¾„ä¿¡æ¯ã€‚
>
> å¥½æ¶ˆæ¯æ˜¯ï¼šæ¨¡å—åŒ–è®¾è®¡è¿˜ç®—æ¸…æ™°ï¼Œå¹¶å‘å¤„ç†ç”¨äº†ä¸‰å±‚çº¿ç¨‹æ± ï¼ŒæŒ‡çº¹åŒ¹é…æœ‰å®Œæ•´çš„ AND/OR é€»è¾‘ã€‚è¿™ä¸æ˜¯ä»é›¶å¼€å§‹çš„çƒ‚æ‘Šå­ï¼Œè€Œæ˜¯ä¸€ä¸ªæœ‰åŸºç¡€ä½†éœ€è¦æ‰“ç£¨çš„é¡¹ç›®ã€‚"

### æ€»ä½“å»ºè®®

- **ç«‹å³è¡ŒåŠ¨**: ä¿®å¤æ‰€æœ‰ P0 çº§åˆ«é—®é¢˜ï¼ˆé¢„è®¡ 8 å°æ—¶ï¼‰
- **æœ¬å‘¨å®Œæˆ**: å¤„ç† P1 çº§åˆ«é—®é¢˜ï¼ˆé¢„è®¡ 24 å°æ—¶ï¼‰
- **æ¶æ„é‡æ„**: æ‹†åˆ† BurpExtender ç±»ï¼Œæå–æ‰«æå¼•æ“
- **é•¿æœŸæ”¹è¿›**: å¼•å…¥å•å…ƒæµ‹è¯•ã€ä¾èµ–æ³¨å…¥ã€LRU ç¼“å­˜

---

## é¡¹ç›®æ¦‚å†µ

### ä»£ç ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| æ€»ä»£ç è¡Œæ•° | ~17,000 è¡Œ |
| Java æ–‡ä»¶æ•° | 88 |
| å¹³å‡æ–‡ä»¶å¤§å° | 181 è¡Œ |
| æœ€å¤§æ–‡ä»¶ | 1,889 è¡Œ (BurpExtender.java) |
| è¶…è¿‡ 500 è¡Œçš„æ–‡ä»¶ | 10 ä¸ª |

### æŠ€æœ¯æ ˆ

- **è¯­è¨€**: Java 17
- **æ„å»ºå·¥å…·**: Maven 3.x
- **æ ¸å¿ƒä¾èµ–**:
  - Burp Extender API 2.3
  - Montoya API 2025.5
  - Gson 2.10.1
  - SnakeYAML 2.2

### æ ¸å¿ƒæ¨¡å—

1. **burp.BurpExtender** - Burp æ’ä»¶ä¸»å…¥å£ï¼ˆ1889 è¡Œï¼‰
2. **burp.onescan.manager** - æŒ‡çº¹ç®¡ç†å’Œå­—å…¸ç®¡ç†
3. **burp.onescan.ui** - ç”¨æˆ·ç•Œé¢ç»„ä»¶
4. **burp.onescan.bean** - æ•°æ®æ¨¡å‹
5. **burp.common** - é€šç”¨å·¥å…·ç±»

---

## é—®é¢˜æ¸…å•

### P0 çº§åˆ«ï¼ˆä¸¥é‡ï¼‰- ç«‹å³ä¿®å¤

#### SEC-001: YAML ååºåˆ—åŒ– DoS æ¼æ´

- **æ–‡ä»¶**: `src/main/java/burp/onescan/manager/FpManager.java:92`
- **æè¿°**: SnakeYAML CodePointLimit è®¾ç½®ä¸º 2,000,000ï¼Œè¿œé«˜äºå®‰å…¨å€¼
- **å½±å“èŒƒå›´**: å…¨å±€ - æ¶æ„ YAML æ–‡ä»¶å¯å¯¼è‡´å†…å­˜æº¢å‡º
- **é£é™©ç­‰çº§**: ä¸¥é‡
- **ä¿®å¤å»ºè®®**: å°† `options.setCodePointLimit()` é™ä½è‡³ 100,000
- **é¢„ä¼°å·¥ä½œé‡**: 0.5 å°æ—¶

```java
// é—®é¢˜ä»£ç 
LoaderOptions options = new LoaderOptions();
options.setCodePointLimit(2_000_000);  // è¿‡é«˜ï¼

// å»ºè®®ä¿®å¤
options.setCodePointLimit(100_000);  // å®‰å…¨å€¼
```

---

#### LGC-001: å­—ç¬¦ç¼–ç é£é™©

- **æ–‡ä»¶**: `src/main/java/burp/common/utils/FileUtils.java:118`
- **æè¿°**: æ–‡ä»¶è¯»å–ä½¿ç”¨å¹³å°é»˜è®¤ç¼–ç ï¼ŒæœªæŒ‡å®š UTF-8
- **å½±å“èŒƒå›´**: å…¨å±€ - FpManager YAML è§£æã€Config JSON è¯»å–
- **é£é™©ç­‰çº§**: ä¸¥é‡ï¼ˆæ•°æ®ä¸¢å¤±ï¼‰
- **ä¿®å¤å»ºè®®**: ç»Ÿä¸€ä½¿ç”¨ `StandardCharsets.UTF_8`
- **é¢„ä¼°å·¥ä½œé‡**: 2 å°æ—¶

```java
// é—®é¢˜ä»£ç 
return new String(result, 0, result.length);  // ä½¿ç”¨ç³»ç»Ÿé»˜è®¤ç¼–ç 

// å»ºè®®ä¿®å¤
return new String(result, 0, result.length, StandardCharsets.UTF_8);
```

**å½±å“çš„æ–‡ä»¶**:
- `FileUtils.java:118` - readFileToString()
- `FileUtils.java:44` - readFile() æœªæŒ‡å®šç¼–ç 
- `GsonUtils.java` - JSON è¯»å–å¯èƒ½ä¹±ç 

---

#### ERR-001: å¼‚å¸¸ä¿¡æ¯æ³„éœ²

- **æ–‡ä»¶**: 14 å¤„ï¼ŒåŒ…æ‹¬ï¼š
  - `FileUtils.java:68, 79, 100, 112, 139`
  - `GsonUtils.java:45, 63, 75, 91`
  - `WordlistManager.java:131, 158`
  - `FpManager.java:87, 108`
  - `Config.java:212`
- **æè¿°**: ç›´æ¥ä½¿ç”¨ `e.printStackTrace()` è¾“å‡ºåˆ° stderrï¼Œæš´éœ²å†…éƒ¨è·¯å¾„å’Œå †æ ˆä¿¡æ¯
- **å½±å“èŒƒå›´**: å…¨å±€ - ç”Ÿäº§ç¯å¢ƒéšç§æ³„éœ²
- **é£é™©ç­‰çº§**: ä¸¥é‡
- **ä¿®å¤å»ºè®®**: å…¨éƒ¨æ›¿æ¢ä¸º `Logger.error("operation failed", e)`
- **é¢„ä¼°å·¥ä½œé‡**: 2 å°æ—¶

```java
// é—®é¢˜ä»£ç 
catch (IOException e) {
    e.printStackTrace();  // æš´éœ²è·¯å¾„ä¿¡æ¯ï¼
    return false;
}

// å»ºè®®ä¿®å¤
catch (IOException e) {
    Logger.error("Failed to read file: %s", e.getMessage());
    return false;
}
```

---

### P1 çº§åˆ«ï¼ˆé«˜ï¼‰- æœ¬å‘¨ä¿®å¤

#### LGC-002: èµ„æºæ³„æ¼é£é™©

- **æ–‡ä»¶**: `src/main/java/burp/common/utils/FileUtils.java:53-73`
- **æè¿°**: æœªä½¿ç”¨ try-with-resourcesï¼Œå¼‚å¸¸æƒ…å†µä¸‹æ–‡ä»¶å¥æŸ„å¯èƒ½æ³„æ¼
- **å½±å“èŒƒå›´**: æ¨¡å—çº§ - é•¿æœŸè¿è¡Œå¯¼è‡´ "Too many open files"
- **é£é™©ç­‰çº§**: é«˜
- **ä¿®å¤å»ºè®®**: å‡çº§è‡³ Java 7+ try-with-resources è¯­æ³•
- **é¢„ä¼°å·¥ä½œé‡**: 3 å°æ—¶

```java
// é—®é¢˜ä»£ç 
public static boolean writeFile(InputStream is, File file) {
    FileOutputStream fos = null;
    try {
        fos = new FileOutputStream(file);
        // ... æ“ä½œ
    } finally {
        IOUtils.closeIO(fos);  // å¦‚æœæ­¤å¤„æŠ›å¼‚å¸¸ï¼Œis æœªå…³é—­
        IOUtils.closeIO(is);
    }
}

// å»ºè®®ä¿®å¤
public static boolean writeFile(InputStream is, File file) {
    try (InputStream input = is;
         FileOutputStream fos = new FileOutputStream(file)) {
        // ... æ“ä½œ
        return true;
    } catch (IOException e) {
        Logger.error("Failed to write file", e);
        return false;
    }
}
```

---

#### LGC-003: æ•°ç»„è¶Šç•Œé£é™©

- **æ–‡ä»¶**: `src/main/java/burp/BurpExtender.java:1015, 1048, 1238-1254`
- **æè¿°**: `split()` ç»“æœæœªæ£€æŸ¥é•¿åº¦ç›´æ¥è®¿é—®æ•°ç»„å…ƒç´ 
- **å½±å“èŒƒå›´**: å±€éƒ¨ - è¿è¡Œæ—¶ ArrayIndexOutOfBoundsException
- **é£é™©ç­‰çº§**: é«˜
- **ä¿®å¤å»ºè®®**: æ·»åŠ è¾¹ç•Œæ£€æŸ¥æˆ–ä½¿ç”¨æ­£åˆ™æ•è·ç»„
- **é¢„ä¼°å·¥ä½œé‡**: 2 å°æ—¶

```java
// é—®é¢˜ä»£ç  (Line 1015)
String key = item.split(": ")[0];  // å¦‚æœä¸å«": "ï¼Œåªè¿”å›é•¿åº¦ 1 çš„æ•°ç»„
String value = item.split(": ")[1];  // è¶Šç•Œï¼

// å»ºè®®ä¿®å¤
String[] parts = item.split(": ", 2);
if (parts.length < 2) {
    Logger.warn("Invalid header format: %s", item);
    continue;
}
String key = parts[0];
String value = parts[1];
```

---

#### SYNC-001: ç«æ€æ¡ä»¶

- **æ–‡ä»¶**: `src/main/java/burp/BurpExtender.java:662, 743, 754`
- **æè¿°**: `checkRepeatFilterByReqId()` è™½ç„¶åŒæ­¥ï¼Œä½†å…¶ä»–åœ°æ–¹ç›´æ¥æ“ä½œ `sRepeatFilter` æœªåŒæ­¥
- **å½±å“èŒƒå›´**: æ¨¡å—çº§ - æ•°æ®ç«äº‰ï¼Œé‡å¤è¯·æ±‚è¿‡æ»¤å¤±æ•ˆ
- **é£é™©ç­‰çº§**: é«˜
- **ä¿®å¤å»ºè®®**: ç»Ÿä¸€åŒæ­¥ç­–ç•¥æˆ–ä½¿ç”¨åŸå­æ“ä½œ
- **é¢„ä¼°å·¥ä½œé‡**: 2 å°æ—¶

```java
// é—®é¢˜ä»£ç 
private synchronized boolean checkRepeatFilterByReqId(String reqId) {
    if (sRepeatFilter.contains(reqId)) {  // TOCTOU é—®é¢˜
        return true;
    }
    return !sRepeatFilter.add(reqId);
}

// å…¶ä»–åœ°æ–¹æœªåŒæ­¥
sRepeatFilter.remove(reqId);  // Line 743, 754 - ç«æ€æ¡ä»¶ï¼

// å»ºè®®ä¿®å¤
private boolean checkAndAddReqId(String reqId) {
    return sRepeatFilter.putIfAbsent(reqId, Boolean.TRUE) != null;
}

private synchronized void removeReqId(String reqId) {
    sRepeatFilter.remove(reqId);
}
```

---

#### LGC-004: æ—¥æœŸæ—¶é—´è§£æé”™è¯¯

- **æ–‡ä»¶**: `src/main/java/burp/BurpExtender.java:1238-1254`
- **æè¿°**: `parseDateTime()` æœªéªŒè¯è¾“å…¥æ ¼å¼ï¼Œç›´æ¥è®¿é—®æ•°ç»„å…ƒç´ 
- **å½±å“èŒƒå›´**: å±€éƒ¨ - åŠ¨æ€å˜é‡æ›¿æ¢å¤±è´¥
- **é£é™©ç­‰çº§**: é«˜
- **ä¿®å¤å»ºè®®**: ä½¿ç”¨ `DateTimeFormatter` æˆ–æ·»åŠ è¾“å…¥éªŒè¯
- **é¢„ä¼°å·¥ä½œé‡**: 1.5 å°æ—¶

---

#### PERF-001: æ— ç•Œç¼“å­˜

- **æ–‡ä»¶**:
  - `burp/onescan/manager/FpManager.java:50-51` - sFpCache, sFpHistory
  - `burp/BurpExtender.java:123` - sRepeatFilter (åˆå§‹åŒ– 500,000)
- **æè¿°**: ç¼“å­˜æ— ä¸Šé™ï¼Œé•¿æœŸè¿è¡Œå¯¼è‡´å†…å­˜æº¢å‡º
- **å½±å“èŒƒå›´**: å…¨å±€ - OOM é£é™©
- **é£é™©ç­‰çº§**: é«˜
- **ä¿®å¤å»ºè®®**: å®ç° LRU ç¼“å­˜æˆ–æ·»åŠ å¤§å°é™åˆ¶
- **é¢„ä¼°å·¥ä½œé‡**: 5 å°æ—¶

```java
// é—®é¢˜ä»£ç 
private static final ConcurrentHashMap<String, List<FpData>> sFpCache =
    new ConcurrentHashMap<>();  // æ— é™å¢é•¿ï¼

// å»ºè®®ä¿®å¤
private static final Cache<String, List<FpData>> sFpCache =
    CacheBuilder.newBuilder()
        .maximumSize(10000)
        .expireAfterAccess(30, TimeUnit.MINUTES)
        .build();
```

---

### P2 çº§åˆ«ï¼ˆä¸­ï¼‰- æœ¬æœˆä¿®å¤

#### PERF-002: parallelStream æ»¥ç”¨

- **æ–‡ä»¶**: `src/main/java/burp/onescan/manager/FpManager.java:591`
- **æè¿°**: æŒ‡çº¹æ•°æ®é€šå¸¸ < 1000 æ¡ï¼ŒparallelStream å¼€é”€ > æ”¶ç›Š
- **å½±å“èŒƒå›´**: å±€éƒ¨ - æ€§èƒ½é€€åŒ–
- **é£é™©ç­‰çº§**: ä¸­
- **ä¿®å¤å»ºè®®**: å°æ•°æ®é›†ä½¿ç”¨æ™®é€š stream
- **é¢„ä¼°å·¥ä½œé‡**: 1 å°æ—¶

---

#### PERF-003: å­—ç¬¦ä¸²æ‹¼æ¥æ€§èƒ½é™·é˜±

- **æ–‡ä»¶**: `src/main/java/burp/BurpExtender.java:1000-1054`
- **æè¿°**: å¾ªç¯ä¸­é¢‘ç¹ä½¿ç”¨ `append()` åˆ›å»ºä¸´æ—¶å¯¹è±¡
- **å½±å“èŒƒå›´**: å±€éƒ¨ - å¤§è¯·æ±‚å¤´å¤„ç†æ—¶å†…å­˜æµªè´¹
- **é£é™©ç­‰çº§**: ä¸­
- **ä¿®å¤å»ºè®®**: é¢„åˆ†é…å®¹é‡æˆ–æ‰¹é‡è¿½åŠ 
- **é¢„ä¼°å·¥ä½œé‡**: 1.5 å°æ—¶

---

#### ARCH-001: ä¸Šå¸ç±»é—®é¢˜

- **æ–‡ä»¶**: `src/main/java/burp/BurpExtender.java` (1,889 è¡Œ)
- **æè¿°**: æ‰¿æ‹… 9 å¤§èŒè´£ï¼Œä¸¥é‡è¿åå•ä¸€èŒè´£åŸåˆ™
- **å½±å“èŒƒå›´**: å…¨å±€ - å¯ç»´æŠ¤æ€§å·®
- **é£é™©ç­‰çº§**: ä¸­
- **ä¿®å¤å»ºè®®**: æå– ScanEngine, RequestBuilder, PayloadProcessor ç­‰ç±»
- **é¢„ä¼°å·¥ä½œé‡**: 16 å°æ—¶

**èŒè´£æ¸…å•**:
1. Burp API é€‚é…
2. è¯·æ±‚æ‹¦æˆªå’Œè¿‡æ»¤
3. ä»»åŠ¡åˆ†å‘
4. è¯·æ±‚å¤„ç†å’Œæ„å»º
5. Payload å¤„ç†
6. åŠ¨æ€å˜é‡æ›¿æ¢
7. é‡å®šå‘è·Ÿè¸ª
8. UI å›è°ƒ
9. çº¿ç¨‹ç®¡ç†

---

#### ARCH-002: UI å±‚è¿‡åº¦è€¦åˆ

- **æ–‡ä»¶**:
  - `burp/onescan/ui/widget/TaskTable.java` (982 è¡Œ)
  - `burp/onescan/ui/tab/DataBoardTab.java` (450 è¡Œ)
- **æè¿°**: UI ç›´æ¥è°ƒç”¨ä¸šåŠ¡ç®¡ç†ç±»ï¼Œæ··åˆ Model/View/Controller
- **å½±å“èŒƒå›´**: æ¨¡å—çº§ - éš¾ä»¥æµ‹è¯•å’Œç»´æŠ¤
- **é£é™©ç­‰çº§**: ä¸­
- **ä¿®å¤å»ºè®®**: å¼•å…¥ MVVM/MVP æ¶æ„åˆ†ç¦»
- **é¢„ä¼°å·¥ä½œé‡**: 12 å°æ—¶

---

### P3 çº§åˆ«ï¼ˆä½ï¼‰- åç»­è¿­ä»£

#### STYLE-001: é­”æ³•æ•°å­—

- **æ–‡ä»¶**: å¤šå¤„
- **æè¿°**: ç¡¬ç¼–ç çš„æ•°å­—ç¼ºä¹è¯­ä¹‰
- **ç¤ºä¾‹**: `8192` (ç¼“å†²åŒº), `500000` (å»é‡é›†åˆ), `50` (YAML åˆ«åé™åˆ¶)
- **ä¿®å¤å»ºè®®**: æå–ä¸ºå‘½åå¸¸é‡
- **é¢„ä¼°å·¥ä½œé‡**: 2 å°æ—¶

---

#### STYLE-002: è¿‡æ·±åµŒå¥—

- **æ–‡ä»¶**: `BurpExtender.java:344-375`
- **æè¿°**: `doScan()` æ–¹æ³• 5 å±‚åµŒå¥—
- **ä¿®å¤å»ºè®®**: æå–å­æ–¹æ³•ï¼Œæ—©è¿”å›ï¼ˆearly returnï¼‰
- **é¢„ä¼°å·¥ä½œé‡**: 2 å°æ—¶

---

#### STYLE-003: æ–¹æ³•è¿‡é•¿

- **é—®é¢˜æ–¹æ³•**:
  - `BurpExtender.doScan()` - 88 è¡Œ
  - `BurpExtender.setupVariable()` - 76 è¡Œ
  - `BurpExtender.buildRequest()` - 65 è¡Œ
- **ä¿®å¤å»ºè®®**: æ‹†åˆ†ä¸ºå¤šä¸ªå°æ–¹æ³•
- **é¢„ä¼°å·¥ä½œé‡**: 4 å°æ—¶

---

#### STYLE-004: ä»£ç é‡å¤

- **ä½ç½®**: `BurpExtender.java:302-322`
- **æè¿°**: Host ç™½åå•/é»‘åå•è¿‡æ»¤é€»è¾‘é‡å¤
- **ä¿®å¤å»ºè®®**: æå–ä¸º `checkHostFilter(host, whitelist, blacklist)` æ–¹æ³•
- **é¢„ä¼°å·¥ä½œé‡**: 1 å°æ—¶

---

#### STYLE-005: å‘½åä¸ä¸€è‡´

- **æè¿°**: æ··ç”¨ `m` å‰ç¼€ï¼ˆæˆå‘˜å˜é‡ï¼‰å’Œ `s` å‰ç¼€ï¼ˆé™æ€å˜é‡ï¼‰ï¼Œä¸è§„èŒƒ
- **ä¿®å¤å»ºè®®**: ç»Ÿä¸€å‘½åé£æ ¼ï¼Œå‚è€ƒ Java ä»£ç è§„èŒƒ
- **é¢„ä¼°å·¥ä½œé‡**: 3 å°æ—¶

---

## ä»£ç åº¦é‡

### å¤æ‚åº¦åˆ†æ

| æŒ‡æ ‡ | å¹³å‡å€¼ | æœ€å¤§å€¼ | è¶…æ ‡æ•°é‡ |
|------|--------|--------|----------|
| æ–‡ä»¶é•¿åº¦ | 181 è¡Œ | 1,889 è¡Œ | 10 ä¸ªæ–‡ä»¶ > 500 è¡Œ |
| æ–¹æ³•é•¿åº¦ | ~15 è¡Œ | 88 è¡Œ | 5 ä¸ªæ–¹æ³• > 50 è¡Œ |
| åµŒå¥—æ·±åº¦ | ~2 å±‚ | 5 å±‚ | 3 ä¸ªæ–¹æ³• > 3 å±‚ |

### æœ€å¤§çš„æ–‡ä»¶ï¼ˆTop 10ï¼‰

1. `BurpExtender.java` - 1,889 è¡Œ âš ï¸ **ä¸¥é‡è¶…æ ‡**
2. `FpManager.java` - 1,124 è¡Œ âš ï¸ **éœ€è¦æ‹†åˆ†**
3. `TaskTable.java` - 982 è¡Œ âš ï¸ **éœ€è¦æ‹†åˆ†**
4. `Config.java` - 455 è¡Œ
5. `DataBoardTab.java` - 450 è¡Œ
6. `FpDetailPanel.java` - 416 è¡Œ
7. `FpColumnManagerWindow.java` - 412 è¡Œ
8. `TableFilterPanel.java` - 366 è¡Œ
9. `FpTable.java` - 362 è¡Œ
10. `WordlistManager.java` - 359 è¡Œ

### ä»£ç è´¨é‡äº®ç‚¹

âœ… **ä¼˜ç‚¹**:
- SafeRegex æä¾› ReDoS é˜²æŠ¤
- ä½¿ç”¨ ConcurrentHashMap/AtomicInteger å¤„ç†å¹¶å‘
- YAML é…ç½®æœ‰åŸºæœ¬å®‰å…¨é™åˆ¶ï¼ˆåˆ«åã€é€’å½’æ·±åº¦ï¼‰
- æ¨¡å—åŒ–è®¾è®¡æ¸…æ™°ï¼ˆ12 ä¸ªåŒ…ï¼‰
- JavaDoc è¦†ç›–ç‡ > 80%

âš ï¸ **éœ€è¦æ”¹è¿›**:
- æ— å•å…ƒæµ‹è¯•ï¼ˆæµ‹è¯•è¦†ç›–ç‡ 0%ï¼‰
- æ— ä¾èµ–æ³¨å…¥ï¼ˆå…¨æ˜¯é™æ€å•ä¾‹ï¼‰
- å­—ç¬¦ç¼–ç å¤„ç†ä¸å½“
- å¼‚å¸¸å¤„ç†ä¸è§„èŒƒ
- ç¼“å­˜æ— é™åˆ¶

---

## æŠ€æœ¯å€ºåŠ¡åˆ†æ

### éœ€è¦é‡æ„çš„æ¨¡å—

1. **BurpExtender.java** (1,889 è¡Œ)
   - **é—®é¢˜**: ä¸Šå¸ç±»ï¼ŒèŒè´£è¿‡å¤š
   - **å»ºè®®**: æ‹†åˆ†ä¸ºç‹¬ç«‹çš„æ‰«æå¼•æ“ã€è¯·æ±‚æ„å»ºå™¨ã€Payload å¤„ç†å™¨
   - **å·¥ä½œé‡**: 16 å°æ—¶
   - **ä¼˜å…ˆçº§**: P2

2. **FpManager.java** (1,124 è¡Œ)
   - **é—®é¢˜**: æ··åˆæŒ‡çº¹åŠ è½½ã€åŒ¹é…ã€ç¼“å­˜ç®¡ç†
   - **å»ºè®®**: åˆ†ç¦»ä¸º FpLoader, FpMatcher, FpCache
   - **å·¥ä½œé‡**: 10 å°æ—¶
   - **ä¼˜å…ˆçº§**: P3

3. **TaskTable.java** (982 è¡Œ)
   - **é—®é¢˜**: UI é€»è¾‘ã€æ•°æ®æ¨¡å‹ã€ä¸šåŠ¡é€»è¾‘æ··åˆ
   - **å»ºè®®**: ä½¿ç”¨ MVVM æ¨¡å¼åˆ†ç¦»
   - **å·¥ä½œé‡**: 12 å°æ—¶
   - **ä¼˜å…ˆçº§**: P2

### å¯ä»¥æå–çš„å…¬å…±ä»£ç 

- **å­—ç¬¦ä¸²ç©ºå€¼æ£€æŸ¥** (15+ å¤„é‡å¤)
- **HTTP è¯·æ±‚å¤´å¤„ç†** (8 å¤„é‡å¤)
- **å¼‚å¸¸æ—¥å¿—æ¨¡å¼** (14 å¤„é‡å¤)
- **Host è¿‡æ»¤é€»è¾‘** (2 å¤„é‡å¤)

### è¿‡æ—¶çš„å®ç°æ–¹å¼

- âŒ æ‰‹åŠ¨ç®¡ç†èµ„æº (åº”ä½¿ç”¨ try-with-resources)
- âŒ é™æ€å•ä¾‹æ¨¡å¼ (åº”ä½¿ç”¨ä¾èµ–æ³¨å…¥)
- âŒ æ— æµ‹è¯•è¦†ç›– (åº”å»ºç«‹æµ‹è¯•æ¡†æ¶)

---

## æ”¹è¿›å»ºè®®ä¼˜å…ˆçº§çŸ©é˜µ

| ä¼˜å…ˆçº§ | é—®é¢˜æ•°é‡ | é¢„ä¼°å·¥ä½œé‡ | å»ºè®®æ‰§è¡Œé¡ºåº | é¢„æœŸæ”¶ç›Š |
|--------|----------|------------|--------------|----------|
| **P0** | 3 | 4.5 å°æ—¶ | **ç«‹å³æ‰§è¡Œ** | æ¶ˆé™¤ä¸¥é‡å®‰å…¨é£é™©å’Œæ•°æ®ä¸¢å¤±é£é™© |
| **P1** | 5 | 13.5 å°æ—¶ | æœ¬å‘¨å®Œæˆ | æå‡ç¨³å®šæ€§ï¼Œé˜²æ­¢èµ„æºæ³„æ¼å’Œå´©æºƒ |
| **P2** | 4 | 31.5 å°æ—¶ | æœ¬æœˆå®Œæˆ | æ”¹å–„æ¶æ„ï¼Œæå‡æ€§èƒ½ |
| **P3** | 5 | 12 å°æ—¶ | åç»­è¿­ä»£ | æå‡å¯ç»´æŠ¤æ€§å’Œä»£ç è§„èŒƒ |
| **æ€»è®¡** | **17** | **61.5 å°æ—¶** | **çº¦ 8 ä¸ªå·¥ä½œæ—¥** | - |

---

## ä¾èµ–åˆ†æ

### ä¾èµ–æ ‘

```
OneScan 2.2.0
â”œâ”€â”€ Burp Extender API 2.3
â”œâ”€â”€ Montoya API 2025.5
â”œâ”€â”€ Gson 2.10.1
â””â”€â”€ SnakeYAML 2.2
```

### å®‰å…¨çŠ¶æ€

- âœ… Gson 2.10.1 - æœ€æ–°ç¨³å®šç‰ˆ
- âœ… SnakeYAML 2.2 - æœ€æ–°ç‰ˆæœ¬
- âœ… Java 17 - LTS ç‰ˆæœ¬
- âš ï¸ æœªé…ç½® OWASP Dependency-Check

### å†—ä½™ä¾èµ–

- æ— 

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³è¡ŒåŠ¨ï¼ˆä»Šæ—¥ï¼‰

1. âœ… å®Œæˆé¡¹ç›®è¯„å®¡ï¼ˆå·²å®Œæˆï¼‰
2. ğŸ”§ ä¿®å¤ SEC-001: é™ä½ YAML CodePointLimit
3. ğŸ”§ ä¿®å¤ LGC-001: ç»Ÿä¸€æ–‡ä»¶ç¼–ç ä¸º UTF-8
4. ğŸ”§ ä¿®å¤ ERR-001: æ›¿æ¢æ‰€æœ‰ printStackTrace()

**é¢„è®¡è€—æ—¶**: 4.5 å°æ—¶

### çŸ­æœŸè®¡åˆ’ï¼ˆæœ¬å‘¨ï¼‰

1. ğŸ”§ ä¿®å¤ LGC-002: æ”¹é€ æ–‡ä»¶ I/O ä¸º try-with-resources
2. ğŸ”§ ä¿®å¤ LGC-003: æ·»åŠ æ•°ç»„è¾¹ç•Œæ£€æŸ¥
3. ğŸ”§ ä¿®å¤ SYNC-001: ç»Ÿä¸€ sRepeatFilter åŒæ­¥ç­–ç•¥
4. ğŸ”§ ä¿®å¤ LGC-004: æ”¹è¿›æ—¥æœŸè§£æ
5. ğŸ”§ ä¿®å¤ PERF-001: æ·»åŠ ç¼“å­˜å¤§å°é™åˆ¶

**é¢„è®¡è€—æ—¶**: 13.5 å°æ—¶

### ä¸­æœŸè®¡åˆ’ï¼ˆæœ¬æœˆï¼‰

1. ğŸ—ï¸ é‡æ„ BurpExtender - æå–æ‰«æå¼•æ“
2. ğŸ—ï¸ é‡æ„ UI å±‚ - å¼•å…¥ MVVM æ¨¡å¼
3. ğŸ”§ ä¼˜åŒ–æ€§èƒ½ - parallelStream å’Œå­—ç¬¦ä¸²å¤„ç†
4. ğŸ“ å»ºç«‹æµ‹è¯•æ¡†æ¶ - JUnit 5 + Mockito

**é¢„è®¡è€—æ—¶**: 31.5 å°æ—¶

### é•¿æœŸè®¡åˆ’ï¼ˆä¸‹å­£åº¦ï¼‰

1. ğŸ—ï¸ å¼•å…¥ä¾èµ–æ³¨å…¥æ¡†æ¶ (Guice)
2. ğŸ“ å•å…ƒæµ‹è¯•è¦†ç›–ç‡è¾¾åˆ° 70%
3. ğŸ”§ ä»£ç è§„èŒƒè‡ªåŠ¨åŒ– (Checkstyle + SpotBugs)
4. ğŸ“š å®Œå–„å¼€å‘æ–‡æ¡£

---

## é™„å½•

### ä½¿ç”¨çš„è¯„å®¡æ–¹æ³•

- âœ… é¡¹ç›®ç»“æ„åˆ†æï¼ˆExplore ä»£ç†ï¼‰
- âœ… é™æ€ä»£ç åˆ†æï¼ˆMaven ç¼–è¯‘ + æ¨¡å¼åŒ¹é…ï¼‰
- âœ… äººå·¥ä»£ç å®¡æŸ¥ï¼ˆå…³é”®æ–‡ä»¶æ·±åº¦é˜…è¯»ï¼‰
- âœ… æ¶æ„è¯„å®¡ï¼ˆæ¨¡å—èŒè´£åˆ†æï¼‰
- âœ… å®‰å…¨è¯„å®¡ï¼ˆæ¼æ´æ¨¡å¼è¯†åˆ«ï¼‰

### è¯„å®¡å·¥å…·

- Maven Compiler (Java 17)
- Grep / Glob æ¨¡å¼åŒ¹é…
- ä»£ç åº¦é‡ç»Ÿè®¡ï¼ˆwc, find, grepï¼‰

### å‚è€ƒèµ„æ–™

- `.claude/skills/code-review/SKILL.md`
- `.claude/skills/code-review/references/burp-api-guide.md`
- Java Code Conventions
- OWASP Top 10

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-12-05 10:00:00 UTC
**å®¡æŸ¥äººç­¾å**: Claude (Linus Torvalds Mode)
