# OneScan æœ€è¿‘20ä¸ªCommitsä»£ç å®¡æŸ¥æŠ¥å‘Š

**å®¡æŸ¥æ—¥æœŸ**: 2025-12-09
**å®¡æŸ¥èŒƒå›´**: æœ€è¿‘20ä¸ªcommits (d42ad3a ~ 0f7a77e)
**å®¡æŸ¥è€…**: Claude (Linus-style Review)

---

## æ‰§è¡Œæ‘˜è¦

### æ€»ä½“è¯„åˆ†: ğŸŸ¡ **Bçº§ (è‰¯å¥½, æœ‰æ”¹è¿›ç©ºé—´)**

**å…³é”®å‘ç°**:
- âœ… **1ä¸ªä¼˜ç§€çš„bugä¿®å¤** (BufferedReader)å±•ç°äº†"å¥½å“å‘³"
- âš ï¸ **7ä¸ªè¿ç»­çš„æŒ‡çº¹ç®¡ç†ä¿®å¤**æš´éœ²äº†æ•°æ®ç»“æ„è®¾è®¡ä¸è¶³
- ğŸ”´ **HTTP/2å›é€€é€»è¾‘æœ‰è¯¯**,åŠŸèƒ½æœªçœŸæ­£å®ç°
- ğŸ”´ **Gitå†å²æ··ä¹±**, åŒ…å«å¤§é‡"auto commit"å’Œä¸´æ—¶æ–‡ä»¶

**ç»Ÿè®¡æ•°æ®**:
- æ€»commits: 20
- Bugä¿®å¤: 8ä¸ª
- åŠŸèƒ½å¢å¼º: 3ä¸ª
- é‡æ„: 2ä¸ª
- è‡ªåŠ¨æäº¤: 6ä¸ª (ğŸ”´ é—®é¢˜)
- CI/CDåŸºç¡€è®¾æ–½: 1ä¸ª

---

## ç¬¬ä¸€éƒ¨åˆ†: Linuså¼æ·±åº¦æ€è€ƒåˆ†æ

### 1. "è¿™æ˜¯ä¸ªçœŸé—®é¢˜è¿˜æ˜¯è‡†æƒ³å‡ºæ¥çš„?"

#### âœ… **çœŸå®é—®é¢˜** (å€¼å¾—ä¿®å¤):

**Commit 6d6f9e0: BufferedReader.ready() ä¿®å¤**
```java
// é”™è¯¯ä»£ç  (before):
while (br.ready()) {  // ä¾èµ–ç¼“å†²åŒºçŠ¶æ€ - éšè—çš„8KBè¾¹ç•Œ
    String line = br.readLine();
}

// æ­£ç¡®ä»£ç  (after):
String line;
while ((line = br.readLine()) != null) {  // ç›´æ¥åˆ¤æ–­æ–‡ä»¶ç»“æŸ
}
```

**å“å‘³è¯„åˆ†**: ğŸŸ¢ **ä¼˜ç§€ (Good Taste)**

**ä¸ºä»€ä¹ˆæ˜¯å¥½å“å‘³**:
1. **æ¶ˆé™¤äº†ç‰¹æ®Šæƒ…å†µ**: 8KBç¼“å†²åŒºè¾¹ç•Œè¿™ä¸ªç‰¹æ®Šæƒ…å†µè¢«å½»åº•æ¶ˆé™¤
2. **æ­£ç¡®çš„æŠ½è±¡å±‚æ¬¡**: ç›´æ¥é—®"æœ‰æ•°æ®å—?"è€Œä¸æ˜¯"ç¼“å†²åŒºå‡†å¤‡å¥½äº†å—?"
3. **å®Œæ•´çš„æµ‹è¯•**: 7ä¸ªæµ‹è¯•ç”¨ä¾‹,ç‰¹åˆ«æ˜¯`testReadStreamToList_LargeFile`ç²¾ç¡®å¤ç°é—®é¢˜
4. **é›¶ç ´åæ€§**: çº¯ç²¹ä¿®å¤é”™è¯¯è¡Œä¸º,ä¸å½±å“æ­£ç¡®ä»£ç 

è¿™æ˜¯æ•™ç§‘ä¹¦çº§çš„bugä¿®å¤æ¡ˆä¾‹ã€‚

---

#### ğŸŸ¡ **åŠçœŸå®é—®é¢˜** (å®ç°æœ‰è¯¯):

**Commit 9434d8b: HTTP/2æ”¯æŒ**

**é—®é¢˜åˆ†æ**:
```java
private byte[] buildHttpRequestWithVersionFallback(...) {
    if (service.secure()) {
        try {
            byte[] http2Request = buildSimpleGetRequest(host, reqPQF, "HTTP/2");
            // åˆ›å»ºä¸´æ—¶è¯·æ±‚æ¥"æµ‹è¯•"HTTP/2æ”¯æŒ â† è¿™é‡Œæœ‰é—®é¢˜
            HttpRequest testRequest = HttpRequest.httpRequest(...);
            return http2Request;  // ä»æœªçœŸæ­£æµ‹è¯•!
        } catch (Exception e) {
            // å›é€€é€»è¾‘
        }
    }
}
```

**è‡´å‘½ç¼ºé™·**:
1. **å‡å›é€€**: ä»£ç åˆ›å»ºäº†testRequestä½†ä»æœªå‘é€,æ— æ³•éªŒè¯æœåŠ¡å™¨æ˜¯å¦æ”¯æŒHTTP/2
2. **æ··æ·†èŒè´£**: HTTP/2åå•†æ˜¯TLS ALPNçš„å·¥ä½œ,ä¸åº”è¯¥åœ¨åº”ç”¨å±‚çŒœæµ‹
3. **è¿‡åº¦å·¥ç¨‹**: Burp Suiteçš„Montoya APIåº”è¯¥è‡ªåŠ¨å¤„ç†åè®®åå•†

**æ­£ç¡®åšæ³•**: è¦ä¹ˆå®Œå…¨åˆ é™¤æ­¤é€»è¾‘,è®©Burpè‡ªåŠ¨åå•†;è¦ä¹ˆçœŸæ­£å®ç°åè®®æµ‹è¯•(ä½†ä¸å»ºè®®)ã€‚

---

#### ğŸ”´ **è¿‡ç¨‹é—®é¢˜** (éä»£ç é—®é¢˜):

**Commits 0f7a77e, b48b13c, 3c2fcb5, c5e92d8, 6b418ef, b8cc5df**

**Gitå†å²æ··ä¹±**:
```
6b418ef: åˆ é™¤ TestReadFile.java (-92è¡Œ)
b8cc5df: æ·»åŠ  TestReadFile.java (+92è¡Œ)  â† åŒä¸€ä¸ªæ–‡ä»¶!
```

**é—®é¢˜æ¸…å•**:
- æ— æ„ä¹‰çš„commit message: "auto commit"
- ä¸´æ—¶æµ‹è¯•æ–‡ä»¶è¿›å…¥ç‰ˆæœ¬æ§åˆ¶
- prompt.mdé¢‘ç¹å¤§å¹…å˜æ›´ (-740è¡Œ, +185è¡Œ)
- è¿åConventional Commitsè§„èŒƒ

**æ ¹æœ¬é—®é¢˜**: è‡ªåŠ¨åŒ–å·¥å…·ç¼ºä¹äººå·¥å®¡æŸ¥,éœ€è¦è§„èŒƒcommitæµç¨‹ã€‚

---

### 2. "æœ‰æ›´ç®€å•çš„æ–¹æ³•å—?"

#### ğŸ”´ **æŒ‡çº¹ç®¡ç†é‡æ„ç³»åˆ—** (7ä¸ªè¿ç»­commits)

**æ—¶é—´çº¿åˆ†æ**:
1. `9fd2741`: ä¼˜åŒ–YAMLæ ¼å¼ (+165 -47)
2. `21371af`: æ·»åŠ è§„åˆ™ç»„æ ‡è¯† (+49 -28)
3. `cbd71bd`: ä¿®å¤å¤šè§„åˆ™ç»„ä¿å­˜æ ¼å¼ (+52 -14)
4. `886aa48`: ä¿®å¤matchers-conditioné€»è¾‘ (+7 -4)
5. `b4ed6ae`: ä¿®å¤è§„åˆ™ç»„ä¸å®æ—¶ä¿å­˜ (+84 -59)
6. `fad57b6`: ä¿®å¤é…ç½®ä¸å®æ—¶ä¿å­˜ (+217)
7. `59cde30`: ç®€åŒ–YAMLå¹¶ç§»é™¤æ—§æ ¼å¼ (+388 -450)

**Linuså¼è´¨é—®**:
> "ä¸ºä»€ä¹ˆä¸€ä¸ª'ä¼˜åŒ–YAMLæ ¼å¼'éœ€è¦ä¿®6æ¬¡æ‰èƒ½æå®š?"

**æ ¹æœ¬é—®é¢˜**:
- æ•°æ®ç»“æ„è®¾è®¡åœ¨å®ç°å‰æ²¡æœ‰æ·±æ€ç†Ÿè™‘
- æ¯æ¬¡å‘ç°é—®é¢˜å°±æ‰“è¡¥ä¸,è€Œéé‡æ–°è®¾è®¡æ•°æ®æ¨¡å‹
- ç¼ºä¹å‰æœŸçš„æ•°æ®æµåˆ†æ

**ä½†æœ€ç»ˆç»“æœæ˜¯å¥½çš„**:
- ä»£ç å‡€å‡å°‘ 62è¡Œ
- ç§»é™¤æ—§æ ¼å¼å…¼å®¹ä»£ç 
- æå‡äº†å¯ç»´æŠ¤æ€§

**æ•™è®­**:
> "ä¸‹æ¬¡é‡åˆ°YAML/JSONæ•°æ®æ ¼å¼è®¾è®¡,åœä¸‹æ¥,èŠ±ä¸€å¤©æ—¶é—´æŠŠæ•°æ®æ¨¡å‹æƒ³æ¸…æ¥š,ç”»å‡ºæ•°æ®æµå›¾,å†™å‡ºSchemaå®šä¹‰,ç„¶åä¸€æ¬¡æ€§å®ç°æ­£ç¡®ã€‚è¿ç»­7ä¸ªè¡¥ä¸çš„ä»£ä»·è¿œå¤§äºå‰æœŸè®¾è®¡çš„æ—¶é—´æŠ•å…¥ã€‚"

---

### 3. "ä¼šç ´åä»€ä¹ˆå—?" (Never break userspace)

#### âœ… **å‘åå…¼å®¹æ€§æ£€æŸ¥**:

**æ‰€æœ‰åŠŸèƒ½æ€§å˜æ›´çš„å…¼å®¹æ€§åˆ†æ**:

| Commit | å˜æ›´ç±»å‹ | ç ´åæ€§è¯„ä¼° | å¤‡æ³¨ |
|--------|---------|-----------|------|
| 6d6f9e0 | Bugä¿®å¤ | âœ… æ— ç ´åæ€§ | ä¿®æ­£é”™è¯¯è¡Œä¸º,ä¸å½±å“æ­£ç¡®ä½¿ç”¨ |
| 59cde30 | é‡æ„ | âœ… æ— ç ´åæ€§ | å†…éƒ¨YAMLæ ¼å¼å˜æ›´,åŠ è½½é€»è¾‘å…¼å®¹ |
| fad57b6 | åŠŸèƒ½å¢å¼º | âœ… æ— ç ´åæ€§ | æ–°å¢å®æ—¶ä¿å­˜,ä¸å½±å“ç°æœ‰åŠŸèƒ½ |
| eb7d6a7 | åŠŸèƒ½å¢å¼º | âœ… æ— ç ´åæ€§ | æ–°å¢isEmpty/isNotEmptyæ“ä½œç¬¦ |
| 9434d8b | åŠŸèƒ½å¢å¼º | âš ï¸ å¯èƒ½å½±å“ | ç§»é™¤ç¡¬ç¼–ç HTTPå¤´éƒ¨,å¯èƒ½æ”¹å˜è¯·æ±‚è¡Œä¸º |

**æ½œåœ¨é£é™©ç‚¹**:
1. **HTTPè¯·æ±‚å¤´éƒ¨ç®€åŒ–** (9434d8b):
   - ç§»é™¤äº† Accept, Accept-Language, Accept-Encoding, Cache-Control
   - å¯èƒ½å½±å“æŸäº›ä¾èµ–è¿™äº›å¤´éƒ¨çš„æœåŠ¡å™¨å“åº”
   - ä½†å¯¹æ‰«æå™¨è€Œè¨€,ç®€åŒ–æ˜¯åˆç†çš„

**æ€»ä½“è¯„ä¼°**: âœ… **å‘åå…¼å®¹æ€§è‰¯å¥½**,æ— é‡å¤§ç ´åæ€§å˜æ›´ã€‚

---

## ç¬¬äºŒéƒ¨åˆ†: åˆ†ç»´åº¦æ·±åº¦å®¡æŸ¥

### P0: æ ¸å¿ƒå®‰å…¨ä¸æ­£ç¡®æ€§

#### 1. å®‰å…¨æ¼æ´å®¡æŸ¥

**æ£€æŸ¥æ–¹æ³•**:
```bash
# æŸ¥æ‰¾ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯
rg -i "password|secret|api_key|token" src/main/java --type java

# æ£€æŸ¥unsafeä»£ç 
rg "unsafe" src/main/java --type java

# æ–‡ä»¶è·¯å¾„æ“ä½œå®‰å…¨æ€§
rg "new File\(|FileUtils\." src/main/java --type java
```

**å‘ç°**:
âœ… **æ— æ˜æ˜¾å®‰å…¨æ¼æ´**

**æ½œåœ¨å…³æ³¨ç‚¹**:
1. **FpManageræ–‡ä»¶è·¯å¾„å¤„ç†**:
```java
public void saveConfig() {
    String yaml = convertConfigToYaml();
    FileUtils.writeFile(mConfigFile, yaml);  // mConfigFileæ¥æºéœ€éªŒè¯
}
```
- `mConfigFile` åœ¨ `init(String path)` æ—¶è®¾ç½®
- æœ‰å‚æ•°æ ¡éªŒ: `if (StringUtils.isEmpty(path) || !FileUtils.isFile(path))`
- è·¯å¾„å®‰å…¨æ€§: âœ… å¯æ¥å—

2. **HTTPè¯·æ±‚æ„å»ºCRLFæ³¨å…¥æ£€æŸ¥**:
```java
private static byte[] buildSimpleGetRequest(String host, String reqPQF, String httpVersion) {
    StringBuilder builder = new StringBuilder()
        .append("GET ").append(reqPQF).append(" ").append(httpVersion).append("\r\n")
        .append("Host: ").append(host).append("\r\n");
}
```
- `reqPQF` å’Œ `host` æœªåšCRLFè¿‡æ»¤
- **ä½†**: è¿™æ˜¯Burp Suiteæ’ä»¶,è¾“å…¥å·²è¢«BurpéªŒè¯
- é£é™©çº§åˆ«: ğŸŸ¢ ä½ (ä¸Šä¸‹æ–‡å®‰å…¨)

**å®‰å…¨è¯„åˆ†**: ğŸŸ¢ **P0é€šè¿‡**

---

#### 2. å†…å­˜å®‰å…¨ä¸èµ„æºç®¡ç†

**æ£€æŸ¥ç‚¹**:

âœ… **èµ„æºæ­£ç¡®å…³é—­**:
```java
try (BufferedReader br = new BufferedReader(new InputStreamReader(is, StandardCharsets.UTF_8))) {
    // try-with-resources è‡ªåŠ¨å…³é—­
}
```

âœ… **LRUç¼“å­˜é˜²æ­¢OOM**:
```java
private static final int MAX_CACHE_SIZE = 10_000;
private static final Map<String, List<FpData>> sFpCache = createLruCache(MAX_CACHE_SIZE);
```

âœ… **YAMLè§£æå®‰å…¨é™åˆ¶**:
```java
private static final int YAML_MAX_ALIASES = 50;
private static final int YAML_CODE_POINT_LIMIT = 100_000;
private static final int YAML_MAX_NESTING_DEPTH = 50;
```

**èµ„æºç®¡ç†è¯„åˆ†**: ğŸŸ¢ **ä¼˜ç§€**

---

#### 3. é”™è¯¯å¤„ç†

**æ£€æŸ¥ç»“æœ**:

âœ… **é€‚å½“çš„å¼‚å¸¸å¤„ç†**:
```java
try {
    saveConfig();
} catch (Exception e) {
    Logger.error("ä¿å­˜æŒ‡çº¹é…ç½®å¤±è´¥", e);  // è®°å½•ä½†ä¸æŠ›å‡º
}
```

âš ï¸ **è¿‡äºå®½æ³›çš„å¼‚å¸¸æ•è·**:
```java
} catch (Exception e) {  // åº”è¯¥æ•è·å…·ä½“å¼‚å¸¸ç±»å‹
    api.logging().logToOutput("HTTP/2 ä¸æ”¯æŒ...");
}
```

**å»ºè®®**: æ•è· `IOException`, `HttpServiceException` ç­‰å…·ä½“å¼‚å¸¸ã€‚

**é”™è¯¯å¤„ç†è¯„åˆ†**: ğŸŸ¡ **è‰¯å¥½,æœ‰å°ç‘•ç–µ**

---

### P1: é‡è¦ä¼˜åŒ–

#### 4. æ€§èƒ½å½±å“è¯„ä¼°

**å…³é”®å˜æ›´åˆ†æ**:

| å˜æ›´ | æ€§èƒ½å½±å“ | åˆ†æ |
|------|---------|------|
| BufferedReaderä¿®å¤ | ğŸŸ¢ æ— å½±å“/è½»å¾®æå‡ | å‡å°‘äº†ready()ç³»ç»Ÿè°ƒç”¨ |
| æŒ‡çº¹å®æ—¶ä¿å­˜ | ğŸŸ¡ æ½œåœ¨I/Oç“¶é¢ˆ | æ¯æ¬¡UIæ“ä½œè§¦å‘æ–‡ä»¶å†™å…¥ |
| YAMLæ ¼å¼é‡æ„ | ğŸŸ¢ æ— å½±å“ | è§£æå¤æ‚åº¦ç›¸åŒ |
| HTTP/2å›é€€é€»è¾‘ | ğŸŸ¢ æ— å½±å“ | ä»…try-catchåŒ…è£… |

**è¯¦ç»†åˆ†æ: æŒ‡çº¹å®æ—¶ä¿å­˜**

**ä»£ç **:
```java
public void addItem(FpData data) {
    // ... ä¿®æ”¹æ•°æ®
    saveConfig();  // â† æ¯æ¬¡è°ƒç”¨éƒ½å†™ç£ç›˜
}
```

**é—®é¢˜**:
- æ‰¹é‡æ·»åŠ 100ä¸ªæŒ‡çº¹ â†’ 100æ¬¡ç£ç›˜I/O
- æ¯æ¬¡å†™å…¥å®Œæ•´YAMLæ–‡ä»¶ (å¯èƒ½å‡ ç™¾KB)

**å®é™…å½±å“è¯„ä¼°**:
- æŒ‡çº¹è§„åˆ™é€šå¸¸æ‰‹åŠ¨æ·»åŠ ,æ•°é‡ä¸å¤§ (< 10ä¸ª/æ¬¡)
- é…ç½®æ–‡ä»¶ä¸å¤§ (< 1MB)
- SSDç¯å¢ƒä¸‹å½±å“å¯å¿½ç•¥

**å»ºè®®**: æ·»åŠ 500ms debounceæœºåˆ¶,åˆå¹¶è¿ç»­ä¿å­˜æ“ä½œã€‚

**æ€§èƒ½è¯„åˆ†**: ğŸŸ¡ **å¯æ¥å—,æœ‰ä¼˜åŒ–ç©ºé—´**

---

#### 5. æ¶æ„è®¾è®¡

**å…³æ³¨ç‚¹**:

âœ… **èŒè´£åˆ†ç¦»è‰¯å¥½**:
- `FpManager`: æŒ‡çº¹ç®¡ç†
- `FileUtils`: æ–‡ä»¶I/O
- `Config`: é…ç½®ç®¡ç†

âœ… **å•ä¸€èŒè´£**:
- è¡¨æ ¼è¿‡æ»¤åŠŸèƒ½ç‹¬ç«‹ (`FilterRule`, `TableFilter`)

âš ï¸ **HTTPè¯·æ±‚æ„å»ºåˆ†æ•£**:
- `BurpExtender.buildSimpleGetRequest()`
- `HttpReqRespAdapter.buildRequest()`
- `MontoyaHttpRequestBuilder.buildRequest()`

ä¸‰å¤„ä»£ç é‡å¤,åº”è¯¥ç»Ÿä¸€åˆ°ä¸€ä¸ªå·¥å…·ç±»ã€‚

**æ¶æ„è¯„åˆ†**: ğŸŸ¢ **è‰¯å¥½**

---

### P2: ä»£ç è´¨é‡

#### 6. ä»£ç è§„èŒƒéµå¾ª

**æ£€æŸ¥æ¸…å•**:

âœ… **å‘½åçº¦å®š**:
- æˆå‘˜å˜é‡: `mConfigFile`, `mTempFile` (må‰ç¼€) âœ…
- é™æ€å˜é‡: `sColorNames`, `sFpCache` (så‰ç¼€) âœ…
- å¸¸é‡: `MAX_CACHE_SIZE`, `OPERATE_EMPTY` (å¤§å†™ä¸‹åˆ’çº¿) âœ…

âœ… **ä½œè€…ä¿¡æ¯**:
```java
/**
 * @author kenyon
 * @mail kenyon <kenyon@noreply.localhost>
 */
```

âœ… **èµ„æºç®¡ç†**:
- ä½¿ç”¨ try-with-resources âœ…
- æ­£ç¡®å…³é—­æµ âœ…

âš ï¸ **Git commitè§„èŒƒ**:
- 6ä¸ª"auto commit"è¿åConventional Commits âŒ

**ä»£ç è§„èŒƒè¯„åˆ†**: ğŸŸ¡ **Bçº§** (ä»£ç è§„èŒƒå¥½,Gitå†å²å·®)

---

#### 7. æµ‹è¯•è¦†ç›–ç‡

**æµ‹è¯•è´¨é‡åˆ†æ**:

**FileUtilsTest (æ–°å¢)**:
- 7ä¸ªæµ‹è¯•ç”¨ä¾‹ âœ…
- è¦†ç›–è¾¹ç•Œæƒ…å†µ (å°æ–‡ä»¶/å¤§æ–‡ä»¶/ç©ºæ–‡ä»¶/ä¸­æ–‡å­—ç¬¦) âœ…
- ç²¾ç¡®å¤ç°bugåœºæ™¯ (8KBè¾¹ç•Œ) âœ…
- è¯¦ç»†çš„æ³¨é‡Šè¯´æ˜æµ‹è¯•æ„å›¾ âœ…

**æµ‹è¯•è¯„åˆ†**: ğŸŸ¢ **ä¼˜ç§€**

---

## ç¬¬ä¸‰éƒ¨åˆ†: å…³é”®Commitsè¯¦ç»†åˆ†æ

### ğŸŸ¢ ä¼˜ç§€Commits

#### Commit 6d6f9e0: BufferedReaderä¿®å¤

**äº®ç‚¹**:
1. é—®é¢˜åˆ†ææ·±åˆ» (8KBç¼“å†²åŒºè¾¹ç•Œ)
2. ä¿®å¤ç®€æ´ä¼˜é›… (2è¡Œä»£ç æ”¹åŠ¨)
3. æµ‹è¯•å®Œæ•´ (7ä¸ªæµ‹è¯•ç”¨ä¾‹)
4. Commit messageè¯¦ç»† (åŒ…å«é—®é¢˜ã€åŸå› ã€æ–¹æ¡ˆã€æµ‹è¯•ã€å½±å“)

**è¿™å°±æ˜¯æ•™ç§‘ä¹¦çº§çš„commit**ã€‚

---

#### Commit eb7d6a7: è¡¨æ ¼è¿‡æ»¤å¢å¼º

**äº®ç‚¹**:
1. åŠŸèƒ½æ¸…æ™° (isEmpty/isNotEmpty)
2. UIè”åŠ¨æ­£ç¡® (æ“ä½œç¬¦é€‰æ‹©æ—¶è‡ªåŠ¨éšè—è¾“å…¥æ¡†)
3. å›½é™…åŒ–å®Œæ•´
4. ä»£ç ç®€æ´

---

### ğŸŸ¡ éœ€è¦æ”¹è¿›çš„Commits

#### Commit 9434d8b: HTTPè¯·æ±‚å¢å¼º

**é—®é¢˜**:
1. HTTP/2å›é€€é€»è¾‘æœªçœŸæ­£å®ç°
2. è¿‡åº¦å·¥ç¨‹åŒ– (åè®®åå•†ä¸åº”åœ¨æ­¤å±‚å¤„ç†)

**å»ºè®®**:
- åˆ é™¤å‡çš„HTTP/2å›é€€é€»è¾‘
- ç®€åŒ–ä¸ºå•çº¯çš„è¯·æ±‚å¤´éƒ¨æ¸…ç†

---

### ğŸ”´ æœ‰é—®é¢˜çš„Commits

#### æŒ‡çº¹ç®¡ç†ç³»åˆ— (7ä¸ªè¿ç»­commits)

**é—®é¢˜**: æ•°æ®ç»“æ„è®¾è®¡è¿­ä»£è¿‡å¤š

**æ•™è®­**: æ•°æ®æ¨¡å‹è®¾è®¡åº”è¯¥å‰ç½®,è€Œéè¾¹å®ç°è¾¹ä¿®å¤

---

#### "auto commit"ç³»åˆ— (6ä¸ªcommits)

**é—®é¢˜**: Gitå†å²æ··ä¹±,ä¸´æ—¶æ–‡ä»¶æ··å…¥

**å»ºè®®**:
1. ç¦ç”¨è‡ªåŠ¨commit,æ”¹ä¸ºæ‰‹åŠ¨å®¡æŸ¥
2. æ·»åŠ  .gitignore è§„åˆ™:
```gitignore
TestReadFile.java
TestReady.java
prompt.md  # æˆ–ç§»åˆ°æ–‡æ¡£ç›®å½•
```

---

## ç¬¬å››éƒ¨åˆ†: é—®é¢˜æ±‡æ€»ä¸ä¼˜å…ˆçº§

### ğŸ”´ P0 (å¿…é¡»ä¿®å¤)

**æ— P0é—®é¢˜**

---

### ğŸŸ¡ P1 (å¼ºçƒˆå»ºè®®)

#### 1. ä¿®å¤æˆ–åˆ é™¤HTTP/2å›é€€é€»è¾‘

**ä½ç½®**: `BurpExtender.java:603`

**å½“å‰ä»£ç **:
```java
private byte[] buildHttpRequestWithVersionFallback(...) {
    // åˆ›å»ºtestRequestä½†ä»æœªçœŸæ­£æµ‹è¯•
}
```

**å»ºè®®æ–¹æ¡ˆA (æ¨è)**: å®Œå…¨åˆ é™¤
```java
// ç›´æ¥ä½¿ç”¨HTTP/1.1,è®©Burpè‡ªåŠ¨åå•†
private static byte[] buildSimpleGetRequest(String host, String reqPQF) {
    return buildSimpleGetRequest(host, reqPQF, "HTTP/1.1");
}
```

**å»ºè®®æ–¹æ¡ˆB**: çœŸæ­£å®ç°æµ‹è¯•
```java
// å‘é€å®é™…è¯·æ±‚æµ‹è¯•HTTP/2æ”¯æŒ
HttpRequestResponse response = api.http().sendRequest(testRequest);
if (response.response().httpVersion().equals("HTTP/2")) {
    // ä½¿ç”¨HTTP/2
}
```

---

#### 2. è§„èŒƒGit Commitæµç¨‹

**é—®é¢˜**: 6ä¸ª"auto commit",ä¸´æ—¶æ–‡ä»¶æ··å…¥

**å»ºè®®**:
1. æ·»åŠ  pre-commit hook:
```bash
#!/bin/bash
# æ£€æŸ¥commit messageæ ¼å¼
msg=$(cat "$1")
if [[ "$msg" =~ ^(feat|fix|refactor|test|docs|chore): ]]; then
    exit 0
else
    echo "Error: Commit message must follow Conventional Commits"
    exit 1
fi
```

2. æ›´æ–° .gitignore:
```gitignore
# ä¸´æ—¶æµ‹è¯•æ–‡ä»¶
Test*.java
# AIäº¤äº’æ–‡ä»¶ (å¦‚æœæ˜¯ä¸´æ—¶æ€§çš„)
prompt.md
```

---

#### 3. ç»Ÿä¸€HTTPè¯·æ±‚æ„å»ºé€»è¾‘

**é—®é¢˜**: ä¸‰å¤„é‡å¤ä»£ç 

**å»ºè®®**: åˆ›å»ºç»Ÿä¸€å·¥å…·ç±»
```java
public class HttpRequestBuilder {
    public static byte[] buildGetRequest(String host, String path) {
        return buildGetRequest(host, path, "HTTP/1.1");
    }

    public static byte[] buildGetRequest(String host, String path, String version) {
        return new StringBuilder()
            .append("GET ").append(path).append(" ").append(version).append("\r\n")
            .append("Host: ").append(host).append("\r\n")
            .append("\r\n")
            .toString().getBytes(StandardCharsets.UTF_8);
    }
}
```

---

### ğŸŸ¢ P2 (å¯é€‰ä¼˜åŒ–)

#### 1. æŒ‡çº¹é…ç½®ä¿å­˜Debounce

**ä»£ç ä½ç½®**: `FpManager.java`

**å»ºè®®å®ç°**:
```java
private static final ScheduledExecutorService sSaveScheduler =
    Executors.newSingleThreadScheduledExecutor();
private static ScheduledFuture<?> sSaveFuture = null;

public void saveConfigDebounced() {
    if (sSaveFuture != null) {
        sSaveFuture.cancel(false);
    }
    sSaveFuture = sSaveScheduler.schedule(() -> {
        saveConfig();
    }, 500, TimeUnit.MILLISECONDS);
}
```

---

#### 2. å¼‚å¸¸å¤„ç†ç²¾ç»†åŒ–

**å½“å‰ä»£ç **:
```java
} catch (Exception e) {  // è¿‡äºå®½æ³›
```

**å»ºè®®**:
```java
} catch (IOException | YAMLException e) {  // å…·ä½“å¼‚å¸¸
```

---

## ç¬¬äº”éƒ¨åˆ†: æœ€ä½³å®è·µä¸åé¢æ¡ˆä¾‹

### âœ… æœ€ä½³å®è·µç¤ºä¾‹

#### 1. BufferedReaderä¿®å¤ (6d6f9e0)

**ä¸ºä»€ä¹ˆæ˜¯æœ€ä½³å®è·µ**:
- é—®é¢˜åˆ†ææ·±åˆ» (ç†è§£8KBç¼“å†²åŒºæœºåˆ¶)
- ä¿®å¤ç®€æ´ (2è¡Œä»£ç )
- æµ‹è¯•å®Œæ•´ (è¦†ç›–è¾¹ç•Œæƒ…å†µ)
- æ–‡æ¡£è¯¦ç»† (commit messageåŒ…å«æ‰€æœ‰ä¿¡æ¯)

---

#### 2. LRUç¼“å­˜è®¾è®¡ (FpManager.java)

**ä»£ç **:
```java
private static <K, V> Map<K, V> createLruCache(int maxSize) {
    return Collections.synchronizedMap(new LinkedHashMap<K, V>(16, 0.75f, true) {
        @Override
        protected boolean removeEldestEntry(Map.Entry<K, V> eldest) {
            return size() > maxSize;
        }
    });
}
```

**ä¸ºä»€ä¹ˆä¼˜ç§€**:
- é˜²æ­¢OOM (é™åˆ¶10000æ¡)
- çº¿ç¨‹å®‰å…¨ (synchronizedMap)
- å®ç°ç®€æ´ (åˆ©ç”¨LinkedHashMapçš„LRUç‰¹æ€§)

---

### âŒ åé¢æ¡ˆä¾‹

#### 1. HTTP/2å‡å›é€€

**ä»£ç **:
```java
HttpRequest testRequest = HttpRequest.httpRequest(...);
return http2Request;  // ä»æœªçœŸæ­£æµ‹è¯•testRequest!
```

**é—®é¢˜**: åˆ›å»ºäº†å¯¹è±¡ä½†æœªä½¿ç”¨,ç»™äººé”™è§‰å·²ç»æµ‹è¯•

---

#### 2. è¿ç»­7ä¸ªè¡¥ä¸ä¿®ä¸€ä¸ªåŠŸèƒ½

**é—®é¢˜**: æ•°æ®ç»“æ„è®¾è®¡ä¸å¤Ÿå‰ç½®

**æ•™è®­**:
> "åœ¨åŠ¨æ‰‹å†™ä»£ç å‰,å…ˆèŠ±è¶³å¤Ÿæ—¶é—´è®¾è®¡æ•°æ®æ¨¡å‹ã€‚ä¸€å¤©çš„è®¾è®¡å¯ä»¥çœä¸‹ä¸€å‘¨çš„è¡¥ä¸ã€‚"

---

## ç¬¬å…­éƒ¨åˆ†: æŠ€æœ¯å€ºåŠ¡è¯„ä¼°

### å€ºåŠ¡æ¸…å•

| ä¼˜å…ˆçº§ | å€ºåŠ¡é¡¹ | ä¼°ç®—ä¿®å¤æ—¶é—´ | å½±å“èŒƒå›´ |
|-------|--------|------------|---------|
| P1 | HTTP/2å‡å›é€€é€»è¾‘ | 1å°æ—¶ | ä½ (åˆ é™¤å³å¯) |
| P1 | Gitå†å²è§„èŒƒåŒ– | 2å°æ—¶ | ä¸­ (æµç¨‹æ”¹è¿›) |
| P1 | HTTPè¯·æ±‚æ„å»ºç»Ÿä¸€åŒ– | 3å°æ—¶ | ä¸­ (é‡æ„) |
| P2 | æŒ‡çº¹ä¿å­˜Debounce | 2å°æ—¶ | ä½ (ä¼˜åŒ–) |
| P2 | å¼‚å¸¸å¤„ç†ç²¾ç»†åŒ– | 1å°æ—¶ | ä½ (ä»£ç è´¨é‡) |

**æ€»ä¿®å¤æ—¶é—´**: çº¦9å°æ—¶ (1ä¸ªå·¥ä½œæ—¥)

---

## ç¬¬ä¸ƒéƒ¨åˆ†: è¡ŒåŠ¨å»ºè®®

### ç«‹å³è¡ŒåŠ¨ (æœ¬å‘¨å†…)

1. **åˆ é™¤HTTP/2å‡å›é€€ä»£ç ** âœ‚ï¸
   - æ–‡ä»¶: `BurpExtender.java`
   - è¡Œæ•°: ~40è¡Œ
   - é£é™©: ä½

2. **æ·»åŠ .gitignoreè§„åˆ™** ğŸ“
   ```gitignore
   Test*.java
   ```

3. **é…ç½®pre-commit hook** ğŸª
   - å¼ºåˆ¶Conventional Commitsæ ¼å¼

---

### çŸ­æœŸä¼˜åŒ– (æœ¬æœˆå†…)

1. **ç»Ÿä¸€HTTPè¯·æ±‚æ„å»ºé€»è¾‘** ğŸ”§
   - åˆ›å»º `HttpRequestBuilder` å·¥å…·ç±»
   - é‡æ„3å¤„é‡å¤ä»£ç 

2. **æ·»åŠ æŒ‡çº¹ä¿å­˜Debounce** âš¡
   - ä¼˜åŒ–æ‰¹é‡æ“ä½œæ€§èƒ½

---

### é•¿æœŸæ”¹è¿› (æŒç»­)

1. **ä»£ç å®¡æŸ¥æµç¨‹è§„èŒƒåŒ–** ğŸ‘¥
   - å»ºç«‹PR Review checklist
   - å¼ºåˆ¶è‡³å°‘1äººå®¡æŸ¥

2. **è‡ªåŠ¨åŒ–æµ‹è¯•å¢å¼º** ğŸ§ª
   - æå‡æµ‹è¯•è¦†ç›–ç‡åˆ°80%+
   - æ·»åŠ é›†æˆæµ‹è¯•

---

## ç»“è®º

### Linuså¼æœ€ç»ˆåˆ¤æ–­

**å“å‘³è¯„åˆ†**: ğŸŸ¡ **Bçº§** (å‡‘åˆ,æœ‰äº®ç‚¹ä¹Ÿæœ‰é—®é¢˜)

**æ ¸å¿ƒæ´å¯Ÿ**:

1. **æ•°æ®ç»“æ„** âœ…
   - BufferedReaderä¿®å¤å±•ç°äº†"å¥½å“å‘³" - æ¶ˆé™¤ç‰¹æ®Šæƒ…å†µ,ä½¿ç”¨æ­£ç¡®æŠ½è±¡
   - ä½†æŒ‡çº¹ç®¡ç†çš„7è¿ä¿®è¯´æ˜æ•°æ®æ¨¡å‹è®¾è®¡ä¸å¤Ÿå‰ç½®

2. **å¤æ‚åº¦** ğŸŸ¡
   - æ•´ä½“å¤æ‚åº¦å¯æ§
   - HTTP/2å›é€€æ˜¯ä¸å¿…è¦çš„å¤æ‚æ€§ (åº”åˆ é™¤)

3. **é£é™©ç‚¹** ğŸŸ¢
   - æ— é‡å¤§å®‰å…¨æ¼æ´
   - å‘åå…¼å®¹æ€§è‰¯å¥½
   - æ€§èƒ½å½±å“å¯æ¥å—

**æœ€å…³é”®å»ºè®®**:

> "ä¸‹æ¬¡è®¾è®¡æ•°æ®æ ¼å¼(YAML/JSON)æˆ–æ ¸å¿ƒæ•°æ®ç»“æ„æ—¶,åœä¸‹æ¥,å…ˆèŠ±ä¸€å¤©æ—¶é—´:
> 1. ç”»å‡ºå®Œæ•´çš„æ•°æ®æµå›¾
> 2. å†™å‡ºSchemaå®šä¹‰æˆ–æ•°æ®ç»“æ„æ–‡æ¡£
> 3. è€ƒè™‘æ‰€æœ‰è¾¹ç•Œæƒ…å†µ
> 4. Reviewæ•°æ®è®¾è®¡,è€ŒéReviewä»£ç 
>
> ä¸€å¤©çš„å‰æœŸè®¾è®¡,å¯ä»¥é¿å…ä¸€å‘¨çš„è¡¥ä¸ä¿®å¤ã€‚
> è¿™ä¸æ˜¯ç†è®ºå®Œç¾ä¸»ä¹‰,è¿™æ˜¯å®ç”¨ä¸»ä¹‰ - èŠ‚çœæ€»å·¥ä½œé‡ã€‚"

---

### æœ€ç»ˆè¯„åˆ†

| ç»´åº¦ | è¯„åˆ† | å¤‡æ³¨ |
|------|------|------|
| å®‰å…¨æ€§ | ğŸŸ¢ A | æ— æ˜æ˜¾æ¼æ´ |
| æ­£ç¡®æ€§ | ğŸŸ¢ A | BufferedReaderä¿®å¤ä¼˜ç§€ |
| æ€§èƒ½ | ğŸŸ¡ B | å®æ—¶ä¿å­˜æœ‰ä¼˜åŒ–ç©ºé—´ |
| ä»£ç è´¨é‡ | ğŸŸ¡ B | è§„èŒƒè‰¯å¥½,Gitå†å²å·® |
| æ¶æ„è®¾è®¡ | ğŸŸ¢ A- | èŒè´£åˆ†ç¦»æ¸…æ™° |
| æµ‹è¯•è¦†ç›– | ğŸŸ¢ A | FileUtilsTestä¼˜ç§€ |
| å‘åå…¼å®¹ | ğŸŸ¢ A | æ— ç ´åæ€§å˜æ›´ |

**ç»¼åˆè¯„åˆ†**: **ğŸŸ¡ B+ (83/100)**

---

### ç»™å¼€å‘è€…çš„è¯

ä½œä¸ºLinus,æˆ‘ä¼šè¿™æ ·è¯´:

> "æ•´ä½“å·¥ä½œæ˜¯solidçš„ã€‚BufferedReaderé‚£ä¸ªä¿®å¤è®©æˆ‘å¾ˆé«˜å…´ - è¿™å°±æ˜¯æˆ‘è¯´çš„'å¥½å“å‘³',ç›´æ¥è§£å†³é—®é¢˜è€Œä¸æ˜¯ç»•åœˆå­ã€‚
>
> ä½†é‚£7ä¸ªæŒ‡çº¹ç®¡ç†çš„è¡¥ä¸...è€å…„,ä¸‹æ¬¡åœ¨æ•²ä»£ç å‰å¤šæƒ³æƒ³æ•°æ®ç»“æ„ã€‚Bad programmers worry about code, good programmers worry about data structures.
>
> è¿˜æœ‰é‚£ä¸ªHTTP/2çš„ä¸œè¥¿ - è¦ä¹ˆåšå¯¹,è¦ä¹ˆåˆ«åšã€‚ç°åœ¨è¿™æ ·æ—¢æ²¡æœ‰çœŸæ­£å®ç°åŠŸèƒ½,åˆå¢åŠ äº†ä»£ç å¤æ‚åº¦,è¿™æ˜¯æœ€ç³Ÿç³•çš„æƒ…å†µã€‚
>
> Gitå†å²ä¹Ÿéœ€è¦æ¸…ç†ä¸€ä¸‹ã€‚'auto commit'ä¸æ˜¯commit message,'TestReadFile.java'ä¸åº”è¯¥è¿›ç‰ˆæœ¬åº“ã€‚è¿™äº›éƒ½æ˜¯åŸºæœ¬çš„ç‰ˆæœ¬æ§åˆ¶å«ç”Ÿã€‚
>
> æ€»çš„æ¥è¯´,æ ¸å¿ƒä»£ç è´¨é‡ä¸é”™,æµ‹è¯•ä¹Ÿå†™å¾—å¥½,ç»§ç»­ä¿æŒã€‚ä½†è¯·è®°ä½:**ç®€å•æ°¸è¿œä¼˜äºå¤æ‚,æ­£ç¡®çš„æ•°æ®ç»“æ„å¯ä»¥ç®€åŒ–90%çš„ä»£ç **ã€‚"

---

**æŠ¥å‘Šç»“æŸ**

*Generated by Claude Code (Linus-style Review) - 2025-12-09*
